# تنظیمات هاست

هدف از تنظیمات هاست، سفارشی سازی کانفیگ ها است.
به کمک تنظیمات هاست، شما میتوانید کانفیگ های خاصی برای هر اینباند بسازید. هر کانفیگ میتواند تنظیمات خاصی داشته باشد. در تنظیمات هاست فیلد های زیر قابل ویرایش هستند.

- Remark
- Address
- Port
- SNI
- Host
- Security Layer (TLS, None)

- ALPN (h2, http/1.1)
- Fingerprint
- Fragment pattern
- Allow Insecure
- Mux
- Random UserAgent

با تنظیماتی که در این بخش انجام میدهید، شما میتوانید برای هر اینباند، چندین آدرس یا دامین با نام های مختلف تعیین کنید. یکی از کاربرد های این بخش این است که اگر سرور شما با تنظیمات خاصی نگهداری میشود، ممکن است لازم باشد پورت اتصال کاربر با پورت اینباند متفاوت باشد. با تنظیمات این بخش شما میتونید پورت اتصال، SNI، هاست و... را سفارشی سازی کنید.

به طور پیشفرض، آیپی سرور به عنوان Address و تنظیمات پیشفرض اینباند (پورت و...) برای هر کانفیگ تنظیم میشود. برای سفارشی سازی کانفیگ ها، لازم است این بخش را ویرایش کنید.

## نکته‌ها

::: tip نکته اول
تنظیمات هاست الویت بالاتری نسبت به تنظیمات دیگر دارد. فیلد هایی که در این این بخش تنظیم می شوند، با بالاترین الویت در تولید کانفیگ ها اعمال میشوند.
:::

::: tip نکته دوم
اگر قصد استفاده از مقادیر `Fragment`,`Allow Insecure`,`Mux`,`Random UserAgent` دارید باید از کاستوم کانفیگ استفاده کنید.
:::

## کاستوم کانفیگ
اگر قصد استفاده از کاستوم کانفیگ مرزبان دارید مراحل زیر رو دنبال کنید.
- نخست پنل خودتون رو به آخرین نسخه آپدیت کنید.
- مقادیر زیر رو به `env.` اضافه کنید.

برای کلاینت های `V2rayN`,`V2rayNG`,`Streisand` :
```env
USE_CUSTOM_JSON_FOR_V2RAYN=True
USE_CUSTOM_JSON_FOR_V2RAYNG=True
USE_CUSTOM_JSON_FOR_STREISAND=True
```
برای تمامی کلاینت ها :
```env
USE_CUSTOM_JSON_DEFAULT=True
```
- سپس مرزبان را ری‌ستارت کنید تا تغییرات اعمال بشه.

### پترن Fragment 

**کاربرد**: فرگمنت با تکه تکه ارسال کردن پکت‌ها اجازه اتصال با دامنه فیلتر شده را به ما خواهد داد.

**پترن صحیح**: `length,interval,packets`

**نمونه‌ها**:

`100-200,10-20,tlshello`

`100-200,10-20,1-3`

::: warning توجه
فعلا این فیچر فقط در کلاینت آیفون `Streisand` ورژن `1.6.12` و کلاینت اندروید `v2rayNG` ورژن `1.8.16` برای کاستوم کانفیگ پشتیبانی می‌شود.
:::

### پترن Noise

**کاربرد**: فایروال برای اجازه دادن به پکت‌های `udp` اولین درخواست را نگاه می‌کند اگر `udp` بود `drop` می‌کند اما با نویز اولین درخواست یک چیز نامعلوم خواهد بود در نتیجه ما روی پروتکل های `udp` مثل `shadowsocks` ، `wireguard` ، ترنزمیشن `splithttp` و همینطور `quic` متصل می‌شویم. 

**پترن صحیح**: `packets,delay`

**نمونه‌ها**:

`rand:10-20,10-20`

`rand:10-20,10-20&base64:7nQBAAABAAAAAAAABnQtcmluZwZtc2VkZ2UDbmV0AAABAAE=,10-25`

::: warning توجه
فعلا این فیچر فقط در کلاینت آیفون `Streisand` ورژن `1.6.32` و کلاینت اندروید `v2rayNG` ورژن `1.8.39` برای کاستوم کانفیگ پشتیبانی می‌شود.
:::

### Mux

**کاربرد**: استفاده کردن از فرگمنت، پینگ را تا حدی بالا خواهد برد و با استفاده از `MUX` شما می‌توانید پینگ را متعادل نگه دارید.

### Random User Agent

**کاربرد**: با فعال کردن این متغیر، یوزر ایجنت بصورت تصادفی خواهد بود که احتمال فیلتر شدن را تا حدی کاهش می‌دهد، و برای پروکسی‌های `noTLS` کاربرد دارد.

## متغیرها
برای سفارشی سازی حداکثری کانفیگ ها متغییر هایی برای هرکدام طراحی شده است. در هر فیلد لازم است از متغیر های همان فیلد استفاده شود.

::: warning توجه
دقت کنید که متغیر ها حتما باید همراه با `}‍` و `{` در فیلد ها قرار داده شوند.
:::

### Remark

| نام متغیر      | توضیحات                                                    |
| -------------- | ---------------------------------------------------------- |
| `{SERVER_IP}`  | آیپی ورژن ۴ سرور                                           |
| `{USERNAME}`   | نام کاربری کاربر                                           |
| `{DATA_USAGE}` | میزان مصرف کاربر                                           |
| `{DATA_LEFT}`  | میزان حجم باقی مانده کاربر                                 |
| `{DATA_LIMIT}` | میزان حجم کلی کاربر                                        |
| `{DAYS_LEFT}`  | روز های باقی مانده از اشتراک کاربر                         |
| `{STATUS_TEXT}`  | وضعیت کاربر به صورت متن (قابل تغییر) , مثلا: Active, Expired و... |
| `{STATUS_EMOJI}`  | وضعیت کاربر به صورت ایموجی , مثلا: ✅,⌛️ |
| `{PROTOCOL}`   | پروتکل کانفیگ مثلا: VMess, VLESS, Trojan و...              |
| `{TRANSPORT}`  | روش ترنسپورت کانفیگ(Transport Method) ، مثلا: ws, tcp و... |


به عنوان مثال:

| فیلد remark                                            | خروجی                           |
| ------------------------------------------------------ | ------------------------------- |
| (\{STATUS_EMOJI\} سرور ‍‍۱ (\{USERNAME\}) [\{PROTOCOL\} - \{TRANSPORT\}] | ✅ سرور ۱ (user102) [VMess - ws] |
| \{DAYS_LEFT\} روز باقی مانده                           | 24  روز باقی مانده              |
| حجم مصرفی: \{DATA_LEFT\}/\{DATA_LIMIT\}                | حجم مصرفی: 16.5GB/30GB          |


### Address

| نام متغیر      | توضیحات                                                    |
| -------------- | ---------------------------------------------------------- |
| `{SERVER_IP}`  | آیپی ورژن ۴ سرور                                           |
| `{USERNAME}`   | نام کاربری کاربر                                           |
| `{DATA_USAGE}` | میزان مصرف کاربر                                           |
| `{DATA_LEFT}`  | میزان حجم باقی مانده کاربر                                 |
| `{DATA_LIMIT}` | میزان حجم کلی کاربر                                        |
| `{DAYS_LEFT}`  | روز های باقی مانده از اشتراک کاربر                         |
| `{STATUS_TEXT}`  | وضعیت کاربر به صورت متن (قابل تغییر) , مثلا: Active, Expired و... |
| `{STATUS_EMOJI}`  | وضعیت کاربر به صورت ایموجی , مثلا: ✅,⌛️ |
| `{PROTOCOL}`   | پروتکل کانفیگ مثلا: VMess, VLESS, Trojan و...              |
| `{TRANSPORT}`  | روش ترنسپورت کانفیگ(Transport Method) ، مثلا: ws, tcp و... |

## تنظیم متن دلخواه برای Status Text
جهت تنظیم متن دلخواه برای `Status Text` مقادیر زیر رو به صورت دلخواه تغییر بدید و در `env.` قرار بدید.
```
ACTIVE_STATUS_TEXT = "Active"
EXPIRED_STATUS_TEXT = "Expired"
LIMITED_STATUS_TEXT = "Limited"
DISABLED_STATUS_TEXT = "Disabled"
ONHOLD_STATUS_TEXT = "On-Hold"
```

## ایجاد عبارت تصادفی

در بعضی مواقع نیاز است بخشی از فیلد های SNI و Host به صورت تصادفی تولید شوند. این تکنیک در بعضی مواقع برای جلوگیری از اتصال های زیاد به یک ساب دامین خاص استفاده میشود. در این صورت هر کاربر به یک ساب دامین تصادفی متصل میشود.

برای استفاده از این قابلیت، در فیلد های SNI و Host از کاراکتر `*` استفاده کنید.


::: warning نکته
توجه داشته باشید که در این صورت لازم است تنظیمات مربوط به wildcard  دامنه انجام شده باشد.
:::


به عنوان مثال:

| فیلد host یا SNI       | نمونه عبارت تولید شده در کانفیگ به ازای این فیلد ها |
| ---------------------- | --------------------------------------------------- |
| `*.example.com`        | 32ks0ef23402.example.com                            |
| `access-*.example.com` | access-laks038fn201.example.com                     |

### چندین Host و SNI

در صورتی که لازم است چندین آدرس مختلف برای Host و SNI تنظیم شود می توانید آن آدرس ها را با `,` از هم جدا کنید. برای هر کاربر به صورت تصادفی یکی از این آدرس ها انتخاب خواهد شد.
